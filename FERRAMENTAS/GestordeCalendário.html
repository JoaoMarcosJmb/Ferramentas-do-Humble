<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor Humble League - Visual Builder</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap');

        :root {
            --cell-width: 150px;
            --cell-height: 140px;
            --text-color: #5d4037;
            --event-bg: #fff8e1;
            --highlight: #ff7043;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #333; /* Fundo escuro fora do calendário para destaque */
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- PAINEL DE CONTROLE --- */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
            max-width: 1100px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 100;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-size: 0.8rem;
            font-weight: bold;
            color: #666;
            text-transform: uppercase;
        }

        input[type="file"], input[type="text"], input[type="date"], input[type="time"] {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        button {
            background-color: var(--highlight);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            height: 100%;
            align-self: flex-end;
        }

        button:hover {
            background-color: #e64a19;
        }

        /* --- ÁREA DO CALENDÁRIO --- */
        #calendarWrapper {
            /* Tamanho fixo baseado no layout visual desejado */
            width: 1150px; 
            min-height: 900px;
            position: relative;
            background-color: #fceeb5; /* Cor padrão caso não tenha imagem */
            background-size: cover; /* A imagem vai cobrir tudo */
            background-position: center;
            background-repeat: no-repeat;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            overflow: hidden; /* Corta o que passar */
        }

        /* Header dos dias da semana */
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            padding-top: 280px; /* ESPAÇO PARA O CABEÇALHO/LOGO DA IMAGEM */
            padding-bottom: 10px;
            margin-left: 50px; /* Margem lateral para centralizar na arte */
            margin-right: 50px;
        }

        .weekday {
            text-align: center;
            font-weight: 700;
            color: #bf360c; /* Tom avermelhado do print */
            font-size: 1.4rem;
            text-shadow: 1px 1px 0px rgba(255,255,255,0.5);
        }

        /* Grade principal */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, var(--cell-width));
            grid-auto-rows: var(--cell-height);
            justify-content: center;
            position: relative;
            margin-bottom: 50px;
        }

        /* Célula individual */
        .day-cell {
            position: relative;
            /* Border removida para usar as imagens como borda */
            display: flex;
            flex-direction: column;
            padding: 8px;
            box-sizing: border-box;
        }

        /* Número do dia (Estilo Imagem 3) */
        .day-number {
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 1.8rem;
            font-weight: 700;
            color: #5d4037; /* Marrom escuro */
            z-index: 5;
        }

        /* Card de Evento (Estilo Imagem 3) */
        .event-card {
            background: #fff8e1;
            border-left: 5px solid var(--highlight);
            padding: 4px 8px;
            border-radius: 4px;
            margin-top: 5px;
            font-size: 0.8rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
            z-index: 10;
            position: relative;
        }

        .event-time {
            font-weight: bold;
            font-size: 0.7rem;
            color: #555;
            margin-bottom: 2px;
        }
        
        .event-title {
            font-weight: 700;
            color: #333;
            line-height: 1.1;
        }

        /* --- ELEMENTOS DA GRADE (PEDRAS/CABOS) --- */
        .grid-asset {
            position: absolute;
            width: 28px; /* Tamanho do ícone da grade */
            height: 28px;
            pointer-events: none;
            z-index: 2; /* Fica acima do fundo, abaixo do texto */
            /* A rotação é via JS */
        }

    </style>
</head>
<body>

    <div class="controls">
        <div class="control-group">
            <label>1. Imagem de Fundo (Praia Limpa)</label>
            <input type="file" id="bgInput" accept="image/*">
        </div>

        <div class="control-group">
            <label>2. Item da Grade (Pedra/Cabo PNG)</label>
            <input type="file" id="assetInput" accept="image/*">
        </div>

        <div style="width: 1px; background: #ddd; margin: 0 10px;"></div>

        <div class="control-group">
            <label>Nome do Evento</label>
            <input type="text" id="evtName" placeholder="Ex: Qualify OU">
        </div>
        <div class="control-group">
            <label>Data</label>
            <input type="date" id="evtDate">
        </div>
        <div class="control-group">
            <label>Horário</label>
            <input type="time" id="evtTime">
        </div>
        <button onclick="addEvent()">+ Adicionar</button>
    </div>

    <div id="calendarWrapper">
        <div class="weekdays">
            <div class="weekday">Domingo</div>
            <div class="weekday">Segunda</div>
            <div class="weekday">Terça</div>
            <div class="weekday">Quarta</div>
            <div class="weekday">Quinta</div>
            <div class="weekday">Sexta</div>
            <div class="weekday">Sábado</div>
        </div>

        <div class="calendar-grid" id="gridContainer">
            </div>
    </div>

    <script>
        // --- ESTADO DO SISTEMA ---
        let gridAssetUrl = null; // Vai guardar a imagem da pedra/cabo
        let currentDate = new Date(2026, 0, 1); // Janeiro 2026
        let events = [
            { id: 1, title: 'Qualify UU', date: '2026-01-04', time: '18:00' },
            { id: 2, title: 'Semanal RU', date: '2026-01-06', time: '19:00' }
        ];

        const gridContainer = document.getElementById('gridContainer');
        const wrapper = document.getElementById('calendarWrapper');

        // --- 1. CONFIGURAÇÃO DE UPLOAD ---
        
        // Upload do Fundo
        document.getElementById('bgInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(file){
                const reader = new FileReader();
                reader.onload = function(event) {
                    wrapper.style.backgroundImage = `url(${event.target.result})`;
                }
                reader.readAsDataURL(file);
            }
        });

        // Upload da Pedra/Cabo
        document.getElementById('assetInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(file){
                const reader = new FileReader();
                reader.onload = function(event) {
                    gridAssetUrl = event.target.result;
                    renderCalendar(); // Redesenha com a nova imagem
                }
                reader.readAsDataURL(file);
            }
        });

        // --- 2. LÓGICA DO CALENDÁRIO ---

        function renderCalendar() {
            gridContainer.innerHTML = ''; 

            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Ajuste simples para começar a grade no domingo correto
            // Para Janeiro 2026, dia 1 é Quinta-feira (index 4)
            const firstDayIndex = new Date(year, month, 1).getDay();
            const lastDay = new Date(year, month + 1, 0).getDate();

            // Células vazias (dias do mês anterior)
            for (let i = 0; i < firstDayIndex; i++) {
                const empty = document.createElement('div');
                empty.className = 'day-cell';
                gridContainer.appendChild(empty);
            }

            // Dias do mês
            for (let day = 1; day <= lastDay; day++) {
                const cell = document.createElement('div');
                cell.className = 'day-cell';

                // Número do dia (Posicionado no canto inferior esquerdo via CSS)
                const num = document.createElement('div');
                num.className = 'day-number';
                num.innerText = day;
                cell.appendChild(num);

                // Eventos
                const dateKey = `${year}-${String(month+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
                const dayEvents = events.filter(e => e.date === dateKey);
                
                dayEvents.forEach(evt => {
                    const el = document.createElement('div');
                    el.className = 'event-card';
                    el.innerHTML = `<div class="event-time">${evt.time}</div><div class="event-title">${evt.title}</div>`;
                    cell.appendChild(el);
                });

                gridContainer.appendChild(cell);
            }

            // --- 3. GERAÇÃO DA GRADE DE IMAGENS ---
            if (gridAssetUrl) {
                renderVisualGrid(firstDayIndex + lastDay);
            } else {
                // Mensagem visual se não tiver asset carregado
                // (Opcional, mas ajuda o usuário a lembrar de carregar)
                console.log("Nenhuma imagem de grade carregada (pedra/cabo)");
            }
        }

        function renderVisualGrid(totalCells) {
            const cols = 7;
            const rows = Math.ceil(totalCells / cols);
            const cellW = 150; // precisa bater com o CSS
            const cellH = 140;

            // Função para colocar uma imagem no grid
            function placeAsset(x, y) {
                const img = document.createElement('img');
                img.src = gridAssetUrl;
                img.className = 'grid-asset';
                
                // Centralizar a imagem no ponto X, Y
                img.style.left = (x - 14) + 'px'; // 14 é metade de 28px (tamanho da img)
                img.style.top = (y - 14) + 'px';

                // Rotação aleatória (-15 a +15 graus)
                const rot = (Math.random() * 30) - 15;
                img.style.transform = `rotate(${rot}deg)`;

                gridContainer.appendChild(img);
            }

            // Loop para criar as "linhas" usando imagens
            for (let r = 0; r <= rows; r++) {
                for (let c = 0; c <= cols; c++) {
                    const x = c * cellW;
                    const y = r * cellH;

                    // Coloca nos cantos (intersecções)
                    placeAsset(x, y);

                    // Coloca no meio da linha horizontal (se não for a última coluna)
                    if (c < cols) {
                        placeAsset(x + (cellW/2), y);
                    }
                    
                    // Coloca no meio da linha vertical (se não for a última linha)
                    // Mas evitamos desenhar vertical se a célula estiver vazia no final da grade
                    // Lógica simplificada: desenha em todas as linhas completas
                    if (r < rows) {
                        placeAsset(x, y + (cellH/2));
                    }
                }
            }
        }

        // --- 4. FUNÇÕES DE EVENTOS ---
        function addEvent() {
            const t = document.getElementById('evtName').value;
            const d = document.getElementById('evtDate').value;
            const h = document.getElementById('evtTime').value;

            if(t && d && h) {
                events.push({ title: t, date: d, time: h });
                renderCalendar();
            } else {
                alert('Preencha os dados do evento');
            }
        }

        // Inicializa
        renderCalendar();

    </script>
</body>
</html>
