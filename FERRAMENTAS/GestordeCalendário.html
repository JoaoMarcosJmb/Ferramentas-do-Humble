<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Gestor Humble League - Web Version</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@600;700&display=swap');

        body {
            background-color: #222;
            color: white;
            font-family: 'Fredoka', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        /* --- CONTROLES (Painel Superior) --- */
        .controls {
            background: #333;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            border: 1px solid #444;
            max-width: 1080px;
            width: 100%;
            justify-content: center;
        }

        .control-group { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 0.75rem; color: #aaa; text-transform: uppercase; letter-spacing: 1px; }
        
        input, button {
            padding: 8px 12px;
            border-radius: 4px;
            border: none;
            font-family: inherit;
            font-size: 0.9rem;
        }
        
        input[type="text"], input[type="date"], input[type="time"] { border: 1px solid #555; }
        input[type="file"] { background: #444; color: white; cursor: pointer; }
        
        button {
            background-color: #ff7043;
            color: white;
            font-weight: bold;
            cursor: pointer;
            height: 100%;
            align-self: flex-end;
            margin-top: auto;
        }
        button:hover { background-color: #f4511e; }

        /* --- O CANVAS (Área da Imagem) --- */
        #calendar-canvas {
            width: 1080px;
            height: 1080px;
            position: relative;
            background-color: #fceeb5; /* Cor de segurança */
            background-size: cover;
            background-position: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            overflow: hidden; /* Corta o que sair da borda */
            flex-shrink: 0;
            user-select: none; /* Evita selecionar texto ao arrastar */
        }

        /* --- ELEMENTOS DO CALENDÁRIO --- */
        
        /* Dias da Semana (Topo) */
        .week-header {
            position: absolute;
            top: 275px; 
            left: 65px;
            width: 950px;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            z-index: 10; /* Fica acima das pedras */
        }

        .weekday-name {
            color: #bf360c;
            font-size: 24px;
            font-weight: 700;
            text-shadow: 2px 2px 0px rgba(255,255,255,0.4);
        }

        /* Container da Grade (Onde ficam os dias) */
        .grid-container {
            position: absolute;
            top: 315px;
            left: 65px;
            width: 950px;
            height: 650px;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(5, 1fr);
            z-index: 10; /* Fica acima das pedras */
            pointer-events: none; /* Deixa clicar através se precisar */
        }

        .day-cell {
            position: relative;
            background-color: transparent; /* TOTALMENTE TRANSPARENTE */
        }

        /* Número do dia */
        .day-number {
            position: absolute;
            bottom: 8px; left: 12px;
            font-size: 28px; font-weight: 700; color: #5d4037;
        }

        /* Estilo do Evento */
        .event-box {
            position: absolute;
            top: 8px; left: 6px; right: 6px;
            background-color: #fff8e1;
            border-left: 5px solid #ff7043;
            padding: 6px 8px;
            border-radius: 6px;
            box-shadow: 2px 2px 6px rgba(0,0,0,0.15);
        }

        .event-time { font-size: 13px; font-weight: 700; color: #666; display: block; margin-bottom: 2px; }
        .event-title { font-size: 15px; font-weight: 700; color: #333; line-height: 1.1; }

        /* --- AS PEDRAS (Estilo) --- */
        /* Container separado para as pedras ficarem ATRÁS dos textos */
        #stones-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; /* Nível mais baixo, acima do fundo */
            pointer-events: none;
        }

        .grid-asset {
            position: absolute;
            width: 32px;  /* TAMANHO DA PEDRA */
            height: 32px;
        }

    </style>
</head>
<body>

    <div class="controls">
        <div class="control-group">
            <label>1. Fundo (Liso)</label>
            <input type="file" id="bgInput" accept="image/*">
        </div>

        <button onclick="drawOrganicGrid()" style="background:#555; margin-left:10px;">Regerar Pedras</button> 
        
        <div style="border-left: 1px solid #555; height: 30px; margin: 0 10px;"></div>

        <div class="control-group">
            <label>Evento</label>
            <input type="text" id="evtName" placeholder="Ex: Qualify OU">
        </div>
        <div class="control-group">
            <label>Data</label>
            <input type="date" id="evtDate" value="2026-01-04">
        </div>
        <div class="control-group">
            <label>Horário</label>
            <input type="time" id="evtTime" value="18:00">
        </div>
        <button onclick="addEvent()">+ Adicionar</button>
    </div>

    <div id="calendar-canvas">
        
        <div id="stones-layer"></div>

        <div class="week-header">
            <div class="weekday-name">Domingo</div>
            <div class="weekday-name">Segunda</div>
            <div class="weekday-name">Terça</div>
            <div class="weekday-name">Quarta</div>
            <div class="weekday-name">Quinta</div>
            <div class="weekday-name">Sexta</div>
            <div class="weekday-name">Sábado</div>
        </div>

        <div class="grid-container" id="gridContainer">
            </div>

    </div>

    <script>
        // --- CONFIGURAÇÃO ---
        // Ajuste este caminho se a imagem estiver em outro lugar
        const ASSET_PATH = '../IMAGENS/pedra.png'; 

        const CONFIG = {
            stonesDensity: 5,   // Quantas pedras por linha da grade (antes era 1 ou 2)
            scatterCount: 150,  // Quantas pedras "jogadas" aleatoriamente na tela
            jitter: 20,         // O quão desalinhadas elas ficam (pixels)
            rotationMax: 45     // Rotação máxima em graus
        };

        // Dados Iniciais
        let events = [
            { title: 'Qualify UU', date: '2026-01-04', time: '18:00' },
            { title: 'Semanal RU', date: '2026-01-06', time: '19:00' },
            { title: 'Final League', date: '2026-01-10', time: '18:00' }
        ];

        const canvas = document.getElementById('calendar-canvas');
        const gridContainer = document.getElementById('gridContainer');
        const stonesLayer = document.getElementById('stones-layer');

        // --- 1. CARREGAR FUNDO ---
        document.getElementById('bgInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(file){
                const reader = new FileReader();
                reader.onload = function(event) {
                    canvas.style.backgroundImage = `url(${event.target.result})`;
                }
                reader.readAsDataURL(file);
            }
        });

        // --- 2. RENDERIZAR DIAS E EVENTOS ---
        function renderCalendar() {
            gridContainer.innerHTML = ''; 
            
            // Configuração da Data: Janeiro 2026
            const baseDate = new Date(2026, 0, 1); 
            
            const year = baseDate.getFullYear();
            const month = baseDate.getMonth();
            const firstDayIndex = new Date(year, month, 1).getDay(); // Dia da semana do dia 1
            const lastDay = new Date(year, month + 1, 0).getDate();

            // Total de células fixas (5 semanas = 35 dias)
            const totalCells = 35;

            for (let i = 0; i < totalCells; i++) {
                const dayNumber = i - firstDayIndex + 1;
                const cell = document.createElement('div');
                cell.className = 'day-cell';

                // Se for um dia válido do mês
                if (dayNumber > 0 && dayNumber <= lastDay) {
                    const num = document.createElement('div');
                    num.className = 'day-number';
                    num.innerText = dayNumber;
                    cell.appendChild(num);

                    // Filtrar eventos
                    const dateKey = `${year}-${String(month+1).padStart(2,'0')}-${String(dayNumber).padStart(2,'0')}`;
                    const daysEvents = events.filter(e => e.date === dateKey);
                    
                    daysEvents.sort((a,b) => a.time.localeCompare(b.time));

                    daysEvents.forEach(evt => {
                        const box = document.createElement('div');
                        box.className = 'event-box';
                        box.innerHTML = `
                            <span class="event-time">${evt.time}</span>
                            <span class="event-title">${evt.title}</span>
                        `;
                        cell.appendChild(box);
                    });
                }
                gridContainer.appendChild(cell);
            }

            // Chama a função das pedras
            drawOrganicGrid();
        }

        // --- 3. DESENHAR AS PEDRAS (O Segredo do Visual) ---
        function drawOrganicGrid() {
            stonesLayer.innerHTML = ''; // Limpa as pedras anteriores
            
            // Definições da área da grade (Baseado no CSS)
            const startX = 65;
            const startY = 315;
            const gridW = 950;
            const gridH = 650;
            const rows = 5;
            const cols = 7;
            
            const cellW = gridW / cols;
            const cellH = gridH / rows;
            const assetSize = 32; // Tamanho da pedra no CSS

            // Função auxiliar para colocar UMA pedra
            function placeStone(x, y) {
                const img = document.createElement('img');
                img.src = ASSET_PATH;
                img.className = 'grid-asset';
                
                // Jitter (Tremor) - deixa a posição irregular
                const jX = (Math.random() * CONFIG.jitter) - (CONFIG.jitter/2);
                const jY = (Math.random() * CONFIG.jitter) - (CONFIG.jitter/2);
                
                // Centraliza e aplica tremor
                img.style.left = (x - (assetSize/2) + jX) + 'px';
                img.style.top = (y - (assetSize/2) + jY) + 'px';
                
                // Rotação
                const rot = (Math.random() * (CONFIG.rotationMax*2)) - CONFIG.rotationMax;
                img.style.transform = `rotate(${rot}deg)`;
                
                // Tratamento de erro silencioso
                img.onerror = function(){ this.style.display='none'; };
                
                stonesLayer.appendChild(img);
            }

            // A. PREENCHER AS LINHAS DA GRADE (Densidade)
            // Percorre todas as linhas horizontais e verticais
            for (let r = 0; r <= rows; r++) {
                for (let c = 0; c <= cols; c++) {
                    const px = startX + (c * cellW);
                    const py = startY + (r * cellH);

                    // 1. Pedra no vértice (cruzamento)
                    placeStone(px, py);

                    // 2. Pedras INTERMEDIÁRIAS nas linhas Horizontais
                    // Se não for a última coluna, desenha pedras entre este ponto e o próximo
                    if (c < cols) {
                        // Cria várias pedras ao longo da linha (ex: 20%, 40%, 60%, 80%)
                        for (let k = 1; k < CONFIG.stonesDensity; k++) {
                            const factor = k / CONFIG.stonesDensity;
                            placeStone(px + (cellW * factor), py);
                        }
                    }

                    // 3. Pedras INTERMEDIÁRIAS nas linhas Verticais
                    if (r < rows) {
                        for (let k = 1; k < CONFIG.stonesDensity; k++) {
                            const factor = k / CONFIG.stonesDensity;
                            placeStone(px, py + (cellH * factor));
                        }
                    }
                }
            }

            // B. CHUVA DE PEDRAS ALEATÓRIAS (Scattering)
            // Joga pedras em posições X,Y totalmente aleatórias dentro da área
            for (let i = 0; i < CONFIG.scatterCount; i++) {
                // Sorteia uma posição qualquer dentro da área da grade
                const randX = startX + (Math.random() * gridW);
                const randY = startY + (Math.random() * gridH);
                
                placeStone(randX, randY);
            }
        }

        // --- 4. ADICIONAR EVENTO ---
        function addEvent() {
            const name = document.getElementById('evtName').value;
            const date = document.getElementById('evtDate').value;
            const time = document.getElementById('evtTime').value;

            if(name && date && time) {
                events.push({ title: name, date: date, time: time });
                renderCalendar(); // Redesenha tudo
            } else {
                alert("Preencha todos os campos!");
            }
        }

        // Inicia o sistema
        renderCalendar();

    </script>
</body>
</html>
