<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Gestor de Calendário - Humble League</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@600;700&display=swap');

        body {
            background-color: #222;
            color: white;
            font-family: 'Fredoka', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h2 { margin-bottom: 10px; color: #ccc; }

        /* --- CONTROLES --- */
        .controls {
            background: #333;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            border: 1px solid #444;
            max-width: 1080px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label { font-size: 0.8rem; color: #aaa; text-transform: uppercase; }
        
        input, button {
            padding: 10px;
            border-radius: 5px;
            border: none;
            font-family: inherit;
        }

        button {
            background-color: #ff7043;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            height: 100%;
            align-self: flex-end;
        }

        button:hover { background-color: #f4511e; transform: scale(1.05); }

        input[type="file"] { background: #444; color: white; }

        /* --- ÁREA DO CALENDÁRIO (1080x1080) --- */
        #calendar-canvas {
            width: 1080px;
            height: 1080px;
            position: relative;
            background-color: #fceeb5; /* Cor base caso esqueça a imagem */
            background-size: cover;
            background-position: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            overflow: hidden;
            /* O fundo será injetado via JS aqui */
        }

        /* --- LAYOUT DA GRADE --- */
        .week-header {
            position: absolute;
            top: 275px; 
            left: 65px;
            width: 950px;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            z-index: 5;
        }

        .weekday-name {
            color: #bf360c;
            font-size: 24px;
            font-weight: 700;
        }

        .grid-container {
            position: absolute;
            top: 315px;
            left: 65px;
            width: 950px;
            height: 650px;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(5, 1fr);
        }

        .day-cell {
            position: relative;
        }

        /* Número do dia */
        .day-number {
            position: absolute;
            bottom: 8px;
            left: 12px;
            font-size: 28px;
            font-weight: 700;
            color: #5d4037;
            z-index: 5;
        }

        /* Eventos */
        .event-box {
            position: absolute;
            top: 8px;
            left: 6px;
            right: 6px;
            background-color: #fff8e1;
            border-left: 5px solid #ff7043;
            padding: 6px 8px;
            border-radius: 6px;
            box-shadow: 2px 2px 6px rgba(0,0,0,0.15);
            z-index: 10;
        }

        .event-time {
            font-size: 13px;
            font-weight: 700;
            color: #666;
            display: block;
            margin-bottom: 2px;
        }

        .event-title {
            font-size: 15px;
            font-weight: 700;
            color: #333;
            line-height: 1.1;
        }

        /* Pedras da Grade */
        .grid-asset {
            position: absolute;
            width: 32px; 
            height: 32px;
            pointer-events: none;
            z-index: 2;
        }

        /* Aviso se a pedra não carregar */
        .img-error-msg {
            color: red;
            font-size: 12px;
            position: absolute;
            top: 0; left: 0;
            background: rgba(0,0,0,0.8);
        }

    </style>
</head>
<body>

    <h2>Gestor de Calendário</h2>

    <div class="controls">
        <div class="control-group">
            <label>1. Carregar Fundo (Calendário Liso)</label>
            <input type="file" id="bgInput" accept="image/*">
        </div>

        <div style="border-left: 1px solid #555; height: 40px; margin: 0 10px;"></div>

        <div class="control-group">
            <label>Evento</label>
            <input type="text" id="evtName" placeholder="Ex: Qualify OU">
        </div>
        <div class="control-group">
            <label>Data</label>
            <input type="date" id="evtDate" value="2026-01-04">
        </div>
        <div class="control-group">
            <label>Horário</label>
            <input type="time" id="evtTime" value="18:00">
        </div>
        <button onclick="addEvent()">+ Adicionar</button>
        <button onclick="renderCalendar()" style="background-color: #555;">Recarregar</button>
    </div>

    <div id="calendar-canvas">
        
        <div class="week-header">
            <div class="weekday-name">Domingo</div>
            <div class="weekday-name">Segunda</div>
            <div class="weekday-name">Terça</div>
            <div class="weekday-name">Quarta</div>
            <div class="weekday-name">Quinta</div>
            <div class="weekday-name">Sexta</div>
            <div class="weekday-name">Sábado</div>
        </div>

        <div class="grid-container" id="gridContainer">
            </div>

    </div>

    <script>
        // --- CONFIGURAÇÃO DE CAMINHOS ---
        // '../' significa: saia da pasta FERRAMENTAS e procure na raiz a pasta IMAGENS
        const ASSET_PATH = '../IMAGENS/pedra.png'; 

        // --- DADOS ---
        let events = [
            { title: 'Qualify UU', date: '2026-01-04', time: '18:00' },
            { title: 'Semanal RU', date: '2026-01-06', time: '19:00' },
            { title: 'Final League', date: '2026-01-10', time: '18:00' }
        ];

        const canvas = document.getElementById('calendar-canvas');
        const gridContainer = document.getElementById('gridContainer');

        // --- 1. CARREGAR FUNDO (UPLOAD) ---
        document.getElementById('bgInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(file){
                const reader = new FileReader();
                reader.onload = function(event) {
                    canvas.style.backgroundImage = `url(${event.target.result})`;
                }
                reader.readAsDataURL(file);
            }
        });

        // --- 2. RENDERIZAR CALENDÁRIO ---
        function renderCalendar() {
            gridContainer.innerHTML = ''; 
            
            // Configuração da Data (Janeiro 2026 fixo ou dinâmico)
            // Para mudar o mês base, altere aqui: (Ano, Mês-1, Dia)
            const baseDate = new Date(2026, 0, 1); 
            
            const year = baseDate.getFullYear();
            const month = baseDate.getMonth();
            const firstDayIndex = new Date(year, month, 1).getDay();
            const lastDay = new Date(year, month + 1, 0).getDate();

            // Vamos criar 35 células fixas (5 linhas x 7 colunas) para manter o visual
            const totalCells = 35;

            for (let i = 0; i < totalCells; i++) {
                const dayNumber = i - firstDayIndex + 1;
                const cell = document.createElement('div');
                cell.className = 'day-cell';

                // Se o dia existe dentro do mês atual
                if (dayNumber > 0 && dayNumber <= lastDay) {
                    // Número
                    const num = document.createElement('div');
                    num.className = 'day-number';
                    num.innerText = dayNumber;
                    cell.appendChild(num);

                    // Eventos
                    const dateKey = `${year}-${String(month+1).padStart(2,'0')}-${String(dayNumber).padStart(2,'0')}`;
                    const daysEvents = events.filter(e => e.date === dateKey);
                    
                    daysEvents.sort((a,b) => a.time.localeCompare(b.time));

                    daysEvents.forEach(evt => {
                        const box = document.createElement('div');
                        box.className = 'event-box';
                        box.innerHTML = `
                            <span class="event-time">${evt.time}</span>
                            <span class="event-title">${evt.title}</span>
                        `;
                        cell.appendChild(box);
                    });
                }

                gridContainer.appendChild(cell);
            }

            // Desenhar a grade (pedras)
            drawGridAssets();
        }

        // --- 3. DESENHAR GRADE (PEDRAS) ---
        function drawGridAssets() {
            const rows = 5;
            const cols = 7;
            
            // Tamanhos calculados baseados no container (950 / 7 e 650 / 5)
            const cellW = 135.7; 
            const cellH = 130;

            function placeAsset(top, left) {
                const img = document.createElement('img');
                img.src = ASSET_PATH;
                img.className = 'grid-asset';
                
                // Centralizar (-16px é metade de 32px)
                img.style.top = (top - 16) + 'px';
                img.style.left = (left - 16) + 'px';
                
                // Rotação orgânica
                const rot = (Math.random() * 30) - 15;
                img.style.transform = `rotate(${rot}deg)`;
                
                // Debug caso a imagem não carregue
                img.onerror = function() { 
                    console.log("Erro ao carregar pedra em: " + ASSET_PATH);
                }

                gridContainer.appendChild(img);
            }

            for (let r = 0; r <= rows; r++) {
                for (let c = 0; c <= cols; c++) {
                    const y = r * cellH;
                    const x = c * cellW;

                    // Pedra no vértice (cruzamento)
                    placeAsset(y, x);

                    // Pedra no meio da horizontal
                    if (c < cols) placeAsset(y, x + (cellW/2));

                    // Pedra no meio da vertical
                    if (r < rows) placeAsset(y + (cellH/2), x);
                }
            }
        }

        // --- 4. ADICIONAR EVENTO ---
        function addEvent() {
            const name = document.getElementById('evtName').value;
            const date = document.getElementById('evtDate').value;
            const time = document.getElementById('evtTime').value;

            if(!name || !date || !time) {
                alert("Preencha todos os campos do evento!");
                return;
            }

            events.push({ title: name, date: date, time: time });
            renderCalendar();
        }

        // Iniciar
        renderCalendar();

    </script>
</body>
</html>
